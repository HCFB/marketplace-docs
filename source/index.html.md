---
title: Markeplace_HC

language_tabs: # must be one of https://git.io/vQNgJ
  - shell


toc_footers:

  - <a href='https://market.homecredit.ru'>Маркетлейс "Товары в рассрочку"</a>

includes:
  - errors

search: true
---

# Общие положения
Добро пожаловать на страницу интеграции с Маркетплейсом Хоум Кредит!

В документации детально описан процесс работы с клиентом от момента выбора товара и до момента взаиморасчета с партнером.

На странице содержатся требования к выгружаемому каталогу товаров и сервису API,который необходимо реализовать партнеру при осуществлении интеграции с Маркетплейсом.

<aside class="notice">
Доступ в Личный кабинет партнера (далее ЛК) предоставляется по согласованию с менеджером, реквизиты доступа высылаются на заявленный адрес электронной почты (e-mail).
</aside>

# Предоставление каталога 

<aside class="warning">
Партнер предоставляет каталог товаров в формате XML.
</aside>

<aside class="notice">
Базовый сценарий предполагает, что на каждый регион необходимо задать свой каталог. Возможен вариант когда каталог товаров един для всех регионов, данный сценарий необходимо предварительно согласовать с менеджером.
</aside>


##Описание параметров выгрузки

Ниже описаны основные параметры для выгрузки каталога. Для успешной синхронизации каталога в нем должны присутствовать все обязательные параметры, а также соблюдаться структура выбранного формата.

Выгруженный каталог может содержать в себе любые другие параметры и элементы, например всю структуру YML (стандарт, разработанный Яндексом для принятия и размещения информации в базе данных Яндекс.Маркета), что не будет вызывать ошибок обработки каталога со стороны Маркетплейс.

##Каталог в формате XML

Каталог обязательно должен иметь XML-заголовок, который начинается с первой строки, с нулевого элемента, в заголовке присутствуют атрибуты версии и используемая кодировка. Допустимые кодировки: UTF-8 или windows-1251. Пример заголовка:

За основу предложенной структуры XML-каталога использован формат выгрузки от [Яндекс.Маркет](https://yandex.ru/support/partnermarket/export/vendor-model.html), соответственно, если уже существует синхронизация с платформой Яндекс, достаточно внести незначительные дополнения, чтобы целевую выгрузку можно было задействовать для платформы Marketplace (минимально достаточно добавить атрибут credit в параметр offer, чтобы обозначить товары, которые планируется продавать в рассрочку)


##Информация о наличии товаров

 Базовый сценарий предполагает, что товар может поступить в любую точку самовывоза в рамках региона за указанный в delivery-options срок.

Если товар есть не во всех точках самовывоза или существует техническое ограничение на перевозку товаров из одного пункта в другой, предусмотрен формат указания списка точек самовывоза для отдельно взятого товара, для этого необходимо использовать параметр points и перечислить в нем точки самовывоза:
 
Список точек самовывоза партнер загружает через Личный кабинет, данный процесс описан в разделе [Предоставление информации о точках самовывоза](#19530bd8b7)





##Процесс загрузки каталога

Подготовленный каталог необходимо указать в настройках аккаунта, которые задаются в Личном кабинете. Для каждого региона необходимо указать свой URL до целевого каталога. В случае, если партнер присутствует во всех регионах и имеет единый товарный каталог, необходимо выбрать “Все регионы” (необходимо предварительное согласование менеджера).

![](image_catalogue.jpeg)


#Предоставление информации о точках самовывоза

Точки самовывоза передаются в виде CSV-таблицы с указанием адреса и режима работы. Необходимо использовать разделитель столбцов "," (запятая).

Загрузка и актуализация списка происходит через Личный кабинет. Если для какого-то регионов не указаны точки самовывоза, Покупателю будет предложен вариант доставки курьером.

При возможности разместить CSV на внешнем источнике, можно указать URL до целевого файла.
![](image_selfservice.jpeg)

##Описание параметров CSV с точками самовывоза
| Параметр                    | Описание                                                                                                                                                                            |
|-----------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `Id`<br> string             | Идентификатор точки самовывоза.                                                                                                                                                     |
| `TradingPoint`<br> integer  | Код торговой точки, соответствующий данному пункту самовывоза. Код кредитного продукта можно уточнить у менеджера, ответственного за работу с банком.                               |
| `RegionCode`<br> integer    | Идентификатор региона. Значение берется из списка регионов, в которых работает маркетплейс. Список регионов будет предоставлен со стороны Marketplace.                              |
| `RegionName`<br> string     | Название региона согласно списку. Значение берется из списка регионов, в которых работает маркетплейс. Список регионов будет предоставлен со стороны Marketplace.                   |
| `Address`<br> string        | Адрес точки самовывоза (произвольное описание).                                                                                                                                     |
| `workingDays`<br> string    | Режим работы в будние дни, формат XX:XX-XX:XX, например 11:00-20:00                                                                                                                 |
| `Saturday`<br> string       | Режим работы в субботу, формат XX:XX-XX:XX, например 11:00-20:00. Если поле остается пустым, берется значение из workingDays, если указано false —в субботу пункт не работает.      |
| `Sunday`<br>  string             | Режим работы в воскресенье, формат XX:XX-XX:XX, например 11:00-20:00. Если поле остается пустым, берется значение из Saturday, если указано false —в воскресенье пункт не работает. |
#Процесс покупки товара

##Покупка товара с доставкой курьером
Данный сценарий предполагает, что Покупатель подписывает договор без участия партнера, после чего инициируется процесс доставки.
![](image_delivery_curier.jpeg)
##Покупка товара с последующим самовывозом
Данный сценарий предполагает, что в точке самовывоза партнера присутствует кредитный специалист, который имеет доступ в систему Банка и полностью сопровождает процесс подписания договора с Покупателем.
![](image_delivery_self.jpeg)

#POST /order/check
**Проверка наличия товара у партнера.**<br>
В момент когда Покупатель выбрал предложение, партнеру поступает запрос на проверку наличия данного товара в регионе. В ответ партнер должен уведомить о возможности зарезервировать товар, а также прислать условия доставки и самовывоза. Расчет параметров получения товара клиентом должен производиться на основе доступных товаров. (Например, если доступно только 3 из 5 переданных в запросе товаров, стоимость доставки должна быть только для этих трех товаров).

## Входные параметры
`POST https://example.com/order/check`
> Пример запроса POST /order/check:

```shell
curl -X POST https://example.com/order/check \
  -H 'Content-Type: application/json' \
  -H 'cache-control: no-cache' \
  -d '{"offersRequest":[
{"offerId":"123",
"quantity":1,
"regionId":77,
"productCode":"0-0-6"}
]}'
```

| Параметр                                     | Обязательность | Описание                                                                           |
|----------------------------------------------|----------------|------------------------------------------------------------------------------------|
| `offersRequest`<br>  Array of [{offerRequest}](#offerrequest) | Обязательно    | Массив объектов с запросами на проверку наличия товаров, которые выбрал Покупатель. |

### объект offerRequest

| Параметр                  | Обязательность | Описание                                                                                                             |
|---------------------------|----------------|----------------------------------------------------------------------------------------------------------------------|
| `offerId` <br> integer    | Обязательно    | Идентификатор товара из YML-каталога.                                                                                |
| `quantity`<br>integer     | Обязательно    | Количество единиц товара для бронирования.                                                                           |
| `regionId` <br>integer    | Обязательно    | Идентификатор региона                                                                                                |
| `productCode`<br> string | Обязательно    | Код кредитного продукта.<br> Примеры:<ul><li>0-0-3</li><li>0-0-6</li><li>0-0-10</li><li>0-0-12</li><li>0-0-18</li><li>0-0-24</li><li>0-0-36</li></ul> |
| `orderId`<br> string      | Необязательно  | Идентификатор заказа, сгенерированный на стороне маркетплейса |

## Параметры ответа
`HTTP status code 200 OK — Список товаров с указанием наличия и условий.`
> Пример ответа в JSON:

```json
{
    "offersResponse": [
        {
            "status": "available",
            "offerId": "123",
            "quantity": 1,
            "points": [
                "0"
            ]
        }
    ],
    "DeliveryOptions": {
        "delivery": [
            {
                "DeliveryID": 1,
                "DeliveryName": "Доставка СДЭК(склад-склад)",
                "Cost": 1000,
                "Days": "1-2"
            }
        ]
    }
}
```

| Параметр | Обязательность | Описание |
|-------------------------------------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|
| offersResponse Array of [{offerResponse}](#offerresponse)| Обязательно | Массив объектов со статусом резерва по каждому из запрошенных товаров. |
| DeliveryOptions [{DeliveryOption}](#deliveryoption)| Обязательно | Дополнительная информация по параметрам доставки, которую сможет выбирать Покупатель. Партнер должен представить варианты доставки для всей группы товаров. |

### объект offerResponse
| Параметр | Обязательность | Описание |
|------------------------------|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `offerId`<br>integer | Обязательно | Идентификатор товара из YML-каталога. |
| `status`<br>string | Обязательно | Варианты:<ul><li>‘available’ — товар доступен;</li><li>‘unavailable’ — товар недоступен.</li></ul> |
| `points`<br> Array of string | Обязательно | Идентификаторы пунктов самовывоза, в которых доступен товар.<br>Также необходимо добавлять в список 0, если доступна доставка курьером. Пустой массив - товар недоступен. |
| `reason`<br>string | Необязательно | Указывается, если товар недоступен (пример: “not in stock”). |

### объект DeliveryOption
| Параметр | Обязательность | Описание  |
|---------------------------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `delivery`<br> Array of Objects | Необязательно | Список вариантов доставки с указанием параметров: <ul><li>deliveryId—идентификатор службы доставки в системе партнера (будет передано при резервировании заказа);</li> <li>deliveryName— название службы доставки (будет отображено Покупателю);</li> <li>cost— стоимость доставки (если параметр отсутствует, то стоимость необходимо уточнять у службы доставки);</li><li> days— время доставки в днях (возможно указать интервал, например “5-7” интерпретируется как “доставка от 5 до 7 дней”).</li></ul>|
| `pickup`<br> Array of Objects | Необязательно | Список точек самовывоза доступные для заказа с указанием параметров:<ul><li> point — идентификатор точки самовывоза из CSV;</li> <li>cost— стоимость за услугу самовывоза, можно указать 0 или не указывать данные параметр если самовывоз бесплатный;</li> <li>days — время доставки товара на точку самовывоза, после которой товар можно забрать, 0 - если можно забрать в тот же день (возможно указать интервал, например “5-7” интерпретируется как “доставка от 5 до 7 дней”).</li></ul> |

## Обработка ошибок
> Пример ответа в JSON:

```json
{"errorFields":[
    {"price": "price is required"},
    {"offerId": "not found"}]
}
```
| Код HTTP | Описание |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 5xx | Внутренняя ошибка сервера партнера. |
| 422 | Неверный формат запроса (указаны неверные или не указаны обязательные параметры запроса). В теле запроса необходимо передавать поля, которые переданы с ошибкой и указывать в чем она заключается.  Формулировка ошибки может быть произвольной строкой (см. пример). |




#POST /order/:orderId/reserve
**Резервирование товара у партнера**<br>
<aside class="notice">
Базовый сценарий предполагает 2 этапа резервирования:
</aside>

**Предрезервирование** — или, так называемое, "краткосрочное" резервирование — Покупатель выбрал товар и приступил к заполнению формы, партнер на вызов данного метода бронирует товар для заданного orderId, который будет использоваться при втором этапе резервирования, метод которого будет вызвано следом. партнер сам определяет время короткого резерва, но значение должно быть не меньше 30 минут

**Резервирование** — после того, как Покупатель заполнил заявку, выбрал способ доставки, партнеру приходит запрос на резервирование товара до момента подписания кредитного договора клиентом.

## Входные параметры
`POST https://example.com/order/:orderId/prereserve`
`POST https://example.com/order/:orderId/reserve`

> Пример запроса POST /order/:orderId/reserve:

```shell
curl -X POST https://example.com/order18022500002104/reserve \
  -H 'Content-Type: application/json' \
  -H 'cache-control: no-cache' \
  -d '{
  "orderId": "18022500002104", 
  "offerIds": [
    {
      "offer": 777, 
      "quantity": 1, 
      "price": 4000.0,
      "priceTotal": 5000.0
    }
    ], 
  "regionId": 77, 
  "pointId": "0",
  "productCode": "0-0-3",
  "client": { "firstName": "Иван", "lastName": "Иванов", "phone": "1244567", "email":"test@test.ru" },
  "address": {"country": "Россия", "region": "Москва", "district": "", "town": "Москва", "locality": "", "street": "Обводного канала", "house": "199", "flat": "", "block": "", "building": "", "zipcode": "190020"}
}'
```

| Параметр | Обязательность | Описание |
|---------------------------------|----------------|--------------------------------------------------------------------------------------|
| `orderId`<br>  string | Обязательно | Идентификатор заказа, сгенерированный на стороне маркетплейса. |
| `offerIds`<br> Array of [{offer}](#offer)| Обязательно | Массив объектов с идентификаторами товаров и их количество. |
| `regionId`<br> integer | Обязательно | Идентификатор региона из списка. |
| `pointId`<br>string | Обязательно | Идентификатор точки самовывоза из CSV, 0 - если выбрана доставка курьером. |
| `deliveryId`<br>integer  | Необязательно | Идентификатор службы доставки в системе партнера. |
| `productCode`<br>string  | Обязательно | Код кредитного продукта.<br> Примеры:<ul><li>0-0-3</li><li>0-0-6</li><li>0-0-10</li><li>0-0-12</li><li>0-0-18</li><li>0-0-24</li><li>0-0-36</li></ul> |
| `address`<br> [{address}](#address)| Необязательно | Адрес в формате КЛАДР, указывается, если выбрана доставка курьером. |
| `client`<br> [{clientInfo}](#clientInfo)| Обязательно(для метода reserve) | Информация о клиенте. |
                           
### объект offer
| Параметр | Обязательность | Описание |
|------------------------|----------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `offerId`<br> integer | Обязательно | Идентификатор товара из YML-каталога. |
| `quantity`<br> integer | Обязательно | Количество единиц товара. |
| `price`<br> float | Обязательно | Цена товара с учетом скидки, предоставляемой партнером. Размер скидки зависит от используемого кредитного продукта (срока рассрочки) и согласован с партнером. |
| `priceTotal`<br> float | Обязательно | Цена товара без учета скидки, то есть стоимость товара, которую партнер заявил в своем каталоге. |
 
### объект address
| Параметр | Обязательность | Описание |
|-----------------------|----------------|----------------------|
| `country`<br>  string | Обязательно | Код страны по КЛАДР. |
| `region`<br> string | Обязательно | Регион. |
| `district`<br>string | Обязательно | Район. |
| `town`<br>string | Обязательно | Город. |
| `locality`<br>string | Обязательно | Населенный пункт. |
| `street` <br>string | Обязательно | Улица. |
| `house`<br> string | Обязательно | Дом. |
| `flat` <br>string | Необязательно | Квартира. |
| `block` <br>string | Необязательно | Корпус. |
| `building` <br>string | Необязательно | Строение. |
| `zipcode` <br>string | Обязательно | Индекс. |

### объект clientInfo
| Параметр | Обязательность | Описание |
|------------------------|----------------|---------------------------------------------------|
| `firstName`<br>string | Обязательно | Имя клиента. |
| `lastName`<br>string | Обязательно | Фамилия клиента. |
| `middleName`<br>string | Необязательно | Отчество клиента. |
| `email`<br>string | Необязательно | E-mail. |
| `phone`<br>string | Обязательно | Телефон клиента. Номер должен быть ровно 10 цифр. |

## Параметры ответа
`HTTP status code 200 OK — Товар предрезервирован(ответ на метод prereserve).`
> Пример ответа в JSON:

```json
{
"status": "prereserved",
"PartnerOrderId": "12345",
"orderId": "18022600000999",
"reserveDuring": 30
}
```

| Параметр | Обязательность | Описание |
|-----------------------------|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `status`<br> string | Обязательно | значение: "prereserved" |
| `reserveDuring` <br>integer | Необязательно | Время в минутах для которого действует предрезервирование (короткий резерв). Если значение не указано, либо оно меньше 30, то будет взято значение по-умолчанию — 30 минут. |
| `partnerOrderId` <br>string | Необязательно | Идентификатор заказа, сгенерированный на стороне партнера. |
             

`HTTP status code 200 OK — Товар зарезервирован(ответ на метод prereserve).`

## Обработка ошибок 
 
